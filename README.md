# Пельменная 

### Как запустить

```bash
docker compose up -d --build
```

### Docker Content Trust

```bash
# Для постоянного включения добавьте в ~/.bashrc
echo "export DOCKER_CONTENT_TRUST=1" >> ~/.bashrc
```

### Многоэтапные сборки (Multi-stage builds)

Для обоих сервисов — **backend** (Go) и **frontend** (Vue.js) — используются многоэтапные сборки. Этот подход позволяет нам разделить среду сборки и среду выполнения:

1.  **Этап сборки (`builder`)**: Этот этап содержит все необходимые инструменты для компиляции и сборки приложения (полный образ Go, Node.js, npm и т.д.).
2.  **Финальный этап (`final`)**: На этот этап копируются **только** скомпилированные артефакты (один бинарный файл для Go, статичные HTML/JS/CSS файлы для Vue). В финальном образе отсутствуют компиляторы, исходный код и ненужные зависимости, что делает его значительно меньше и безопаснее.

### Выбор базовых образов и итоговые размеры

Выбор минималистичного базового образа для финального этапа — ключевой аспект безопасности и эффективности. Мы использовали разные стратегии для бэкенда и фронтенда, чтобы наилучшим образом соответствовать их природе.

#### Backend (Go)

*   **Базовый образ**: `gcr.io/distroless/static-debian12`
*   **Обоснование**:
    *   **Безопасность**: `distroless` образы от Google содержат только самое необходимое для запуска приложения: базовые библиотеки ОС и сам бинарный файл. В них **нет пакетного менеджера, shell и других утилит**, что радикально сокращает поверхность для атаки. Если злоумышленник получит доступ к контейнеру, у него практически не будет инструментов для дальнейших действий.
    *   **Размер**: Так как наше Go-приложение скомпилировано статически (`CGO_ENABLED=0`), оно не требует внешних зависимостей. Образ `distroless/static` идеально для этого подходит. Он один из самых маленьких доступных образов, содержащих необходимые CA-сертификаты.
*   **Итоговый размер образа**: `~12-15 МБ`

#### Frontend (Vue.js + Nginx)

*   **Базовый образ**: `nginx:stable-alpine`
*   **Обоснование**:
    *   **Производительность**: Nginx является промышленным стандартом для раздачи статического контента. Он высокопроизводителен и способен обрабатывать тысячи одновременных подключений.
    *   **Размер и безопасность**: Мы используем тег `-alpine`, который основан на дистрибутиве Alpine Linux. Alpine известен своей минималистичностью. Это позволяет получить полностью функциональный веб-сервер в очень компактном образе, что также снижает количество потенциальных уязвимостей по сравнению с образами на базе Debian или Ubuntu.
    *   **Функциональность**: Nginx также выступает в роли **Reverse Proxy**, перенаправляя API-запросы на бэкенд-сервис. Это позволяет нам скрыть бэкенд от внешнего мира и управлять всем трафиком через единую точку входа.
*   **Итоговый размер образа**: `~25-30 МБ`
